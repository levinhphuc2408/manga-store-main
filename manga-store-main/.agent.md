# Manga Store - Full Stack Application

## Project Overview

This is a full-stack manga e-commerce application built with:
- **Backend**: Node.js + Express.js + MongoDB (Mongoose)
- **Frontend**: Vue 3 + Vite + TailwindCSS + Pinia
- **Authentication**: JWT-based with role-based access control
- **Database**: MongoDB with local connection

## Architecture

### Backend Structure (`/backend`)
- **Framework**: Express.js with CORS enabled
- **Database**: MongoDB via Mongoose ODM
- **Authentication**: JWT tokens with bcrypt password hashing
- **Environment**: Uses dotenv for configuration

#### Key Backend Files
- `server.js` - Main application entry point
- `config/db.js` - Database connection configuration
- `models/` - Mongoose schemas (User, Manga, Order)
- `controllers/` - Business logic handlers
- `routes/` - API endpoint definitions
- `middleware/` - Authentication and authorization middleware

#### API Routes
- `/api/auth` - User registration and login
- `/api/mangas` - Manga CRUD operations
- `/api/orders` - Order management
- `/api/admin` - Admin-only operations

### Frontend Structure (`/frontend`)
- **Framework**: Vue 3 with Composition API
- **Build Tool**: Vite
- **Styling**: TailwindCSS v4
- **State Management**: Pinia stores
- **Routing**: Vue Router with navigation guards

#### Key Frontend Files
- `src/App.vue` - Main application component
- `src/router/index.js` - Route definitions with auth guards
- `src/stores/` - Pinia state management (user, cart)
- `src/views/` - Page components
- `src/components/` - Reusable UI components

## Data Models

### User Model
- `username` (String, required, unique)
- `email` (String, required, unique)
- `password` (String, required, hashed)
- `role` (String, default: 'user') - supports 'user' and 'admin'

### Manga Model
- `title` (String, required)
- `author` (String, required)
- `genre` (String)
- `price` (Number, required)
- `stock` (Number, default: 0)
- `coverImage` (String) - URL or local path
- `description` (String)

### Order Model
- `userId` (ObjectId, optional) - for guest checkout support
- `customer` (Object) - name, email, phone
- `items` (Array) - manga items with quantity and price
- `totalPrice` (Number, required)
- `status` (String) - 'pending' or 'completed'

## Development Setup

### Backend Setup
```bash
cd backend
npm install
npm run dev  # Uses nodemon for hot reload
```

### Frontend Setup
```bash
cd frontend
npm install
npm run dev  # Vite dev server
```

### Environment Configuration
Backend requires `.env` file with:
- `PORT` - Server port (default: 5000)
- `MONGO_URI` - MongoDB connection string
- `JWT_SECRET` - Secret key for JWT signing

## Authentication & Authorization

### Authentication Flow
1. User registers/logs in via `/api/auth` endpoints
2. JWT token stored in localStorage
3. Token included in API requests via Authorization header
4. Frontend Pinia store manages user state and token

### Route Protection
- **Frontend**: Vue Router navigation guards check auth status
- **Backend**: Middleware validates JWT tokens
- **Admin Routes**: Additional role-based checks for admin access

### User Roles
- **user**: Can browse, purchase, view orders
- **admin**: Full access including manga management

## State Management (Pinia)

### User Store (`stores/user.js`)
- Manages authentication state
- Handles token and user data persistence
- Provides login/logout functionality

### Cart Store (`stores/cart.js`)
- Manages shopping cart items
- Calculates totals and quantities
- Supports add/remove/update operations

## Styling & UI

### TailwindCSS Configuration
- Uses TailwindCSS v4 with Vite plugin
- Dark theme with gray-900 background
- Responsive design patterns
- Custom component styling in Vue SFCs

### Component Structure
- `Navbar.vue` - Navigation with auth-aware menu
- `MangaCard.vue` - Reusable manga display component
- `Footer.vue` - Site footer
- View components for each major page

## API Integration

### Frontend API Calls
- Uses Axios for HTTP requests
- Base URL: `http://localhost:5000/api`
- Error handling with loading states
- Automatic token inclusion for authenticated requests

## Best Practices & Conventions

### Code Organization
- Separate concerns between frontend/backend
- Use composition API in Vue components
- Implement proper error handling
- Follow RESTful API design patterns

### Security
- Password hashing with bcrypt
- JWT token expiration handling
- Input validation and sanitization
- CORS configuration for cross-origin requests

### Development Workflow
- Use nodemon for backend hot reload
- Vite for fast frontend development
- Environment-based configuration
- Modular component architecture

## Common Development Tasks

### Adding New API Endpoints
1. Create controller function in `backend/controllers/`
2. Add route definition in `backend/routes/`
3. Include route in `server.js`
4. Add frontend service calls in components

### Adding New Pages
1. Create Vue component in `frontend/src/views/`
2. Add route definition in `router/index.js`
3. Configure auth requirements if needed
4. Add navigation links in Navbar component

### Database Operations
- Use Mongoose models for data operations
- Implement proper error handling
- Consider pagination for large datasets
- Use population for related data

## Troubleshooting

### Common Issues
- **CORS errors**: Check backend CORS configuration
- **Auth failures**: Verify JWT secret and token format
- **Database connection**: Ensure MongoDB is running locally
- **Build errors**: Check Node.js and npm versions

### Development Tools
- MongoDB Compass for database inspection
- Vue DevTools browser extension
- Network tab for API debugging
- Console logs for state tracking